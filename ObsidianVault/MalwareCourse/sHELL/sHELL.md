## Overview

In this assignment, you will implement `sHELL`, a simple yet functional command-line shell for Windows. 

sHELL (Hellish Shell) is a basic shell targeting the windows operating system. It is modular in its design, and restricted in the libraries it can link against. While it is intended to be a teaching shell, it is directly relevant to the Capstone project for this course. In particular, throughout the course, students will implement basic features of their implant as modules for sHELL. The goal is to ensure each student has a bare bones implementation of the majority of the required functionality. 
Unlike traditional shells, `sHELL` is designed to work with a minimal set of libraries, relying primarily on the Windows API and custom implementations of standard functionalities. Your shell will support basic commands, each implemented as a separate dynamically loaded plugin (DLL).

In particular, this project will test your understanding of the Windows API, dynamic loading of libraries, and interfacing between modular components. Each command will be implemented as its own plugin, requiring you to design and adhere to a consistent API for communication between the shell and its plugins.

## Project Structure

Your project should be structured as follows:

- `sHELL/`: The main shell application.
- `src/`: The directory containing the source code for the main shell application. It has no commands implemented 
- `libs/`: Directory for all command plugins. Each command will have its own subdirectory here.
- `libs/include/`: Contains shared header files, including the definition of `InternalAPI` and plugin interfaces for each command.
- To better understand what is required to make a command, please read through **all** the files in `libs/template`, `libs/include`, and `src/*`
	- You are welcome to read through `utils.*` and the command line parser code, but this is strictly optional


## Common Requirements for All Plugins

Each plugin must implement and export the following functions:

- `CommandNameA()`: Returns the command name (e.g., "cd").
- `CommandHelpA()`: Returns a help message describing the command's usage.
- `CommandRunA(int argc, char **argv)`: Contains the logic to execute the command.
- `CommandInit(InternalAPI *lpCore)`: Initializes the plugin with core functionalities provided by `sHELL`. Usually this entails passing the Virtual Address of the InternalAPI struct implemented in the main shell. This way, functionality can be shared by plugins.
- It also shares the array containing all modules, and the index of the next free module entry. 
	- In particular, modules can reference other modules!
	
The `InternalAPI` struct will be provided to you and includes pointers to functions for printing to the console, memory management, and other utilities.

## Restrictions 
Unless otherwise specified, there is no use of any libc functionality. In particular,  this means when compiling with mingw, the `-nostd` flag is passed, and as a result, the final binary won't link against msvcrt.dll.  It is an automatic zero to include any functions form msvcrt.dll.

## Interface
To start, sHELL  separates all of its functionality into a handful of DLLs. These DLLs are stored in a fixed location, and loaded as needed at runtime.  At the start of execution, sHELL will load all of the DLLs in a fixed location and register them as being functions that are available. To make development more ergonomic, each library must implement the following "interface"

![[Interface]]

several helper functions are provided for convenience. This includes 
- `wprintf`: note that this is **not** the usual C implementation of wprintf. You are expected to read the documentation for `kernel32.dll!wprintf`, as well as the Microsoft format specifiers for printf/wprintf 
- Remember: Visual C is **not** c
- `s_malloc/s_free`: rough implementations of the usual `malloc/free` functions using `kernel32.dll!HeapAlloc` and `kernel32.dll!HeapFree`
- Utilities around parsing command lines
- Basic program loop 
- Sample DLL 

Over time, you will modify sHELL to 
1) use no imports 
2) Drop usage of LoadLibraryA/GetProcAddress 

# Functionality 
## Built in 
- [[clear]]
- [[echo]]
- [[template]]


## Remarks
Note that the descriptions and structs are provided to convenience. They may change from release to release. Please refer to the source code for the ground truth . 