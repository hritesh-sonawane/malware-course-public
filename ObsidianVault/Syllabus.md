

# CS 501Â 

Introduction to Malware, Threat Hunting and Offensive Capabilities Development

  

## Course Developers

Kai Bernardini
Winnona DeSombre

  

## Instructor
Kai BernardiniÂ 
- Remove `ðŸ¤ `
E-m-a-i-l:
`kðŸ¤ .ðŸ¤ bðŸ¤ eðŸ¤ rðŸ¤ nðŸ¤ aðŸ¤ rðŸ¤ dðŸ¤ iðŸ¤ nðŸ¤ iðŸ¤ @ðŸ¤ nðŸ¤ oðŸ¤ rðŸ¤ tðŸ¤ hðŸ¤ eðŸ¤ aðŸ¤ sðŸ¤ tðŸ¤ eðŸ¤ rðŸ¤ nðŸ¤ .ðŸ¤ eðŸ¤ dðŸ¤ uðŸ¤ `

# Totally Legit email  for Scrapers
[kai](mailto:ek43sqvre0ccyozcb9626ip37@canarytokens.com)


# Course DescriptionÂ Â 
The class introduces students to the wild world of offensive capabilities development and cyber threat hunting by taking on the role of both attacker and defender to better understand various stages of cyber attacks.Â  Focusing on the Windows operating system, students will create and analyze malware in the context of combating a simulated threat actor APT-ChonkyBear in addition to creating their own tools to emulate their capabilities.Â 

  

## PreReqs:

### Tools:
- GDB/experience debuggingÂ  native binaries
- Experience with compiler toolchains (compilers, linkers)

## Programing/scripting:
- Python3: you need to be very proficient with python.
- c/c++/some other systems programming language: you should be able to write simple C programs, know the difference between Stack and Heap memory, and how to manage memory. You don't need to be Dennis Ritchie but pointers arithmetic shouldn't scare you. You should also be comfortable with structs. 
- Intel x86 assembly: you should be able to read x86 assembly.Â  Being able to write it is a plus!

## Protocols:
- IP : you should know the difference between a private and public IP, the basics of addressing, and know the relationship between a domain name, DNS and an IP address
	- I.e. If you should understand why 10.10.10.3 isn't a valid Malicious IP address  
- TCP: More so the basics of socket programming, less so the internals of how reliability is achieved or what the handshake process looks like.
- DNS: You don't need to understand **how** DNS works, but you need to know what it does.
- TLS: You need to understand what a Certificate Authority is, a TLS cert is, and the basics of establishing secure tunnelsÂ 
- HTTP(s): HTTP verbs, request structure, and error codes.
	- You should know what a User-Agent is

## Courses/topics:
- Combinatorics.Â 
- Probability
- Computing systems : familiarity with memory management, c programming, reading assembly, using debuggers and compiler toolchains. You should know the difference between stack and heap memory.
- Basic Cryptography: familiarity with Ciphers, MACs and Hash functions. Ideally also the idea behind asymmetric cryptography.Â 
- Computer Networks: TCP/IP, TLS, UDP HTTP(s), DNS

## Grading:

Subject to change. 

- Malware Write up: 10%Â Â 
- Exercises: 5%
- Capture the Flag (CTF): 10%
- Reverse Engineering Assignments: 15%Â 
- Coding Assignments: 10%
- Capstone Project: 50% 

Bonus Points:
- Class Participation: 2.5%Â 
- Guest lecture attendance  2.5%


### AssignmentsÂ 

Assignments in this class are divided into one of three primary categories:Â 
  

#### ExercisesÂ 

Exercises are weekly, quick turn around homework, and in class assignments .They are designed to be sanity checks for topics as the course progresses.They are questions that should take between 5 and 10 minutes. Questions will always be based on recent material, but topics build on each other. You should bring your laptop to class in case there is an exercise.   

### Malware Reverse Engineering

Each assignment consists of a new epoch of malware sent to students highlighting a new technique to analyze. It will be their job to reverse engineer the new implant, detail its functionality, and identify attacker infrastructure and IOCs. These assignments will often be multi staged and difficult. It is easy to spend hours reverse engineering a binary if you're not careful

### Coding/Malware Development Â 

On the offensive side, students will work to recreate capabilities observed within new epochs of malware that can be integrated into their own Command and Control (C2) framework.Â  For more on this, see Capstone


### Capture the Flag (CTF)

The course will have a semester-long capture the flag competition where students will compete to solve challenges.Â 


### Capstone

This class will guide students through the creation of their own production ready Remote Administration Tool (RAT) andÂ  Command and Control (C2) team server. Each component of the capstone will be introduced as an offensive homework assignment, and will be integrated into the framework over the course of the semester. 

### References:

There are no mandatory textbooks for this course. Required readings will consist of blog posts, or source code. Below are several references that will be relevant to various homework assignments

-   Practical Malware Analysis: The Hands-On Guide to Dissecting Malicious Software 1st Edition    
-   Practical Reverse Engineering: x86, x64, ARM, Windows Kernel, Reversing Tools, and Obfuscation 1st Edition
-   Operator Handbook: Red Team + OSINT + Blue Team Reference
-   Rtfm: Red Team Field Manual 1.0 Edition    
-   Blue Team Field Manual (BTFM)
-   http://www.harmj0y.net/blog/empyre/building-an-empyre-with-python/
-   https://vx-underground.org
-   [https://github.com/yeyintminthuhtut/Awesome-Red-Teaming](https://github.com/yeyintminthuhtut/Awesome-Red-Teaming)
    

  
  
  
**