---
theme: night
height: 540
margin: 0
maxScale: 4
slideNumber: true
---

<!-- slide bg="[[Green Logo.svg]]" background-size="auto" -->

---


<!-- slide template="[[Split Vertical]]" -->
::: title
#### CS-4973
:::
::: left
![[Green Logo.svg | 400]] <!-- element style="object-fit: cover" -->

:::
::: right
<!-- element style="font-size: 32px;align:center" -->
Introduction to Malware, Threat Hunting & Offensive Capabilities Development
:::


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### CS-501

:::

<!-- element style="font-size: 24px"-->
- Introduction to Malware, Threat Hunting & Offensive Capabilities Development


---
<!-- slide template="[[Title Slide]]" -->
 ## Reminder:
 CFAA is a a big hammer.

---
<!-- slide template="[[Title Slide]]" -->
 ## Lecture 1: 
Basics of Real Life Threat Analysis 
Learning an entirely new language 
---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Definitions are important
:::

::: left
<!-- element style="font-size: 24px"-->
- Specialist language facilitates precise communication about complex topics.
- Infosec is full of technical jargon and corporate speak.
- It is also full of marketing teams that make up their own jargon.

:::

::: right
![[0x01_slide_4_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Definitions are important
:::

::: left
<!-- element style="font-size: 24px"-->
- Unfortunately, unlike Mathematics, there really isn’t a single  (trustworthy!) authority for definitions. 
- There are efforts in place to standardize vocabulary, but you will likely have context dependent jargon depending on where you work.
- Military folks, Intelligence community vets, policy wonks, hackers and Punks, all have their own culture, definitions, and slang. 
- You will encounter folks with all kinds of ideas and political beliefs. 
- Many of whom have large platforms. Some with really bad takes dressed up in legitimizing jargon.


:::

::: right
![[0x01_slide_5_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### BS Detector 
:::

::: left
<!-- element style="font-size: 24px"-->
- Seriously, having a good nose for BS will go a long way. Infosec is saturated  with it.
- Infosec is especially tricky, as it evolves rapidly.
- Many people (myself included) constantly feel like they are  behind the curve and 
playing
catch up
- Marketers 
capitalize
 on this to make you feel out of the loop :) 


:::

::: right
![[0x01_slide_6_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Technical Definitions

:::

<!-- element style="font-size: 24px"-->
- Malware
- Threat Hunting
- Offensive Cyber Capabilities

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions

:::

<!-- element style="font-size: 24px"-->
- Malware
Unwanted, m
alicious software. 
- It has a bunch of definitions, and can get very meta.
- At the end of the day, it is code that “does a thing” that the person who ran it might not either expect or want.
- Context matters. Is PSExec Malware? Is Slack malware? Is RDP malware? Is Exchange Malware? Is 
Crowdstrike’s
 EDR malware?  


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Common activities performed by malware 

:::

<!-- element style="font-size: 24px"-->
- Host enumeration: whoami, whereami, whatami
- Network enumeration: what can I talk to, where can I get to?
- Execute: Powershell, Batch, shellcode…etc
- Download: get data into the computer
- Exfiltrate: get data out of the computer 
- Process Manipulation: start, list, modify, and kill processes
- External Messaging: communicate with an 
external
 server
- Are these indicators of a malicious program? 


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### https://www.zdnet.com/article/wacom-drawing-tablets-track-every-app-you-open/

:::

::: left
<!-- element style="font-size: 24px"-->


:::

::: right
![[0x01_slide_10_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Malware is Subjective
:::

::: left
<!-- element style="font-size: 24px"-->
- The line between analytics and marketing and spyware can get 
blurred
 pretty quickly

:::

::: right
![[0x01_slide_11_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Is Slack Malware
:::

::: left
<!-- element style="font-size: 24px"-->
- Slack is a 
messaging
 service 
- Slack allows you to host static files of any type and create public download links. 
- Slack lets you script communication in its messenger, and can be used as a communication channel 
- https://threatpost.com/attackers-discord-slack-malware/165295/

:::

::: right
![[0x01_slide_12_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### PSExec: Goodware?
:::

::: left
<!-- element style="font-size: 24px"-->
- PSExec is a utility from the sysinternals suite of tools.
- It is used to execute powershell commands/scripts on a remote machine and is incredibly useful for sysadmins 
- It is also 
commonly
 used in offensive cyber operations 
	- Note that it is less common now because it became the 
default
 method for many popular tools, and vendors got good at flagging it. 
	- It is still commonly used by crimeware.
- https://www.mandiant.com/resources/a-nasty-trick-from-credential-theft-malware-to-business-disruption

:::

::: right
![[0x01_slide_13_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Is Crowdstrike’s Agent Malware (Falcon)

:::

<!-- element style="font-size: 24px"-->
- Short answer: No…well kind of but seriously no. 
- It acts a lot like malware does! If you ever gain control of a 
company's
 Falcon endpoint, they are probably screwed! 
- Falcon is a a set of tools designed to “stop breaches”
- It does so by gathering telemetry, spying on processes, and alerting/responding to activity it deems malicious. 
- https://github.com/Mr-Un1k0d3r/EDRs/blob/main/EDRs.md


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Definitions
:::

::: left
<!-- element style="font-size: 24px"-->
- What makes malware different from an antivirus?
- How is a hacked 
exchange
 server any 
different
 from a dedicated 
malicious
 server?
- Is Crowdstrike malware with (really) good marketing?
- Meme src: 
https://twitter.com/__winn


:::

::: right
![[0x01_slide_15_image.jpg|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Quick remark about Weird Machines

:::

<!-- element style="font-size: 24px"-->
- What if I execute malicious code only using instructions inside of a legitimate program?
- Is PDF parser malware?
- Recommended
 reading: 
- https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions

:::

<!-- element style="font-size: 24px"-->
- Malware
: Unwanted, malicious software 
[has a bunch of definitions, can get very meta]
- Threat Hunting
: Searching environments to detect and isolate malicious activity.
- 
---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions (for this class)

:::

<!-- element style="font-size: 24px"-->
- Malware
: Unwanted, malicious software 
[has a bunch of definitions, can get very meta]
- Threat Hunting
: Searching environments to detect and isolate malicious activity.
- Blue Team
Analysis/Detection of new malicious activity, creating detection rules, attribution. 
- Red Team
Attribution re: attacker environments, and/or emulation of real malicious activity.
- There are other team “colors” that we do not cover in this class. 


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions (for this class)

:::

<!-- element style="font-size: 24px"-->
- Red Team Engagement
: An exercise involving (ideally) an external entity that provides continuous testing and validation of security controls for an organization. 
- While not totally accurate, it can be a useful starting point to think of a red team engagement as an open scope penetration test. 
- I.e., the folks carrying out the exercise will more open rules of engagement. This definition can also get very meta, and is borrowed from military jargon. 
- ROE: What am I, the (fake) attacker, allowed to do during this exercise?

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions (for this class)

:::

<!-- element style="font-size: 24px"-->
- Blue Team
: an internal entity responsible for detecting, and remediating security incidents. 
- These are the folks who work around the clock to catch red teamers in addition to real threats. 

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions

:::

<!-- element style="font-size: 24px"-->
- Malware
: malicious software 
[has a bunch of definitions, can get very meta]
- Threat Hunting
: Searching environments to detect and isolate malicious activity.
- Blue Team
Analysis/Detection of new malicious activity, creating detection rules, attribution. 
- Red Team
Attribution re: attacker environments, and/or emulation of real malicious activity. 

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions 

:::

<!-- element style="font-size: 24px"-->
- Offensive Cyber Capabilities
- For this class, we’ll define it as “A device or computer that allows an adversary to execute on an objective during a cyber operation.”
- Note this can also get very meta.

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Offensive Cyber Capabilities
:::

::: left
<!-- element style="font-size: 24px"-->
- Example: 
Wiper malware that is capable of bricking PCs
- Non-Example: 
Rockets that could be used to blow up AWS 
data centers
 to take a country offline
- Gray-Area:
 Neurolink super-squirrels that can be used to chew through fiber optic cables

:::

::: right
![[0x01_slide_23_image.png|300]]


:::

---
<!-- slide template="[[Title Slide]]" -->
 ## Cyber Operations 101
---
<!-- slide template="[[Base Slide]]" -->
::: title
#### What is a Cyber Operation?

:::

<!-- element style="font-size: 24px"-->
- Well…It is an operation that takes place in 
cyberspace


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Many types of actors conduct cyber operations

:::

<!-- element style="font-size: 24px"-->
- Criminals
- Hacktivists
- Mercenaries/Private Industry
- Literal 
children
- Government/Government backed Actors


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Many types of actors conduct cyber operations

:::

<!-- element style="font-size: 24px"-->
- Advanced Persistent Threats (APTs): 
usually associated with Government actors, but any actor conducting cyber operations that can consistently target a set of victims and succeed can fall under this category. 

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Many types of actors conduct cyber operations

:::

<!-- element style="font-size: 24px"-->
- Advanced Persistent Threats (APTs): 
usually associated with Government actors, but any actor conducting cyber operations that can consistently target a set of victims and succeed can fall under this category. 
- Large criminal groups with tacit government approval/protection (FINs)
- Cyber Mercenaries / Contractors (APT3 -> Boyusec, Appin Security, Positive Technologies, NSO Group )
- Government Intelligence Agencies (FSB -> APT29, RGB -> Lazarus Group, NSA TAO → Equation/G0020)


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Why conduct cyber operations?

:::

<!-- element style="font-size: 24px"-->
- I.e. What is the tactical objective of a cyber operation?

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Why conduct cyber operations?

:::

<!-- element style="font-size: 24px"-->
- Activism 
(DDoS attacks to shut down Nazi sites, defacing government websites)
- Crime 
(Ransomware, stealing credentials, installing coin miners)
- Espionage 
[CNE] (commercial vs. geopolitical -> stealing Intellectual Property / state secrets)
- “Warfare”
 [CNA] (Shutting down a country’s internet, disrupting power grids, making nuclear centrifuges spin too fast, etc). 
- Clout/Trolling/fun 
Go to Shodan.io and search for sites with an HTML title “Hacked by*”


---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Why conduct cyber operations?

:::

<!-- element style="font-size: 24px"-->
- Activism 
(DDoS attacks to shut down Nazi sites, defacing government websites)
- Crime
(Ransomware, access brokers, stealing credentials, installing coin miners)
- Espionage
[CNE] (commercial vs. geopolitical -> stealing IP / state secrets)
- “Warfare”
 [CNA] (Shutting down a country’s internet, making nuclear centrifuges spin too fast, etc). 


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Some actors do a mix
:::

::: left
<!-- element style="font-size: 24px"-->
- North Korea: 
- Bank heists
- Ransomware attacks
- Hack & Leak
- Destructive malware
- Espionage 
- - Img: https://www.bbc.com/news/stories-57520169


:::

::: right
![[0x01_slide_32_image.jpg|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 1: OPM hack
:::

::: left
<!-- element style="font-size: 24px"-->
- Target: Gov
Attacker: Gov (espionage)
Benefit:  intel/counterintel
- “The compromised data included SF-86 forms which contain intimate details about the prospective employee’s personal life, family members, and other contacts.”


:::

::: right
![[0x01_slide_33_image.jpg|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 2: Twitter hack
:::

::: left
<!-- element style="font-size: 24px"-->
- Target: Corporation/
Individuals
Attacker: Users / Individuals
Benefit: Ego + Money
- What else could he have done?
- Does social engineering count as an offensive cyber capability?


:::

::: right
![[0x01_slide_34_image.jpg|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 3: Monitoring 
:::

::: left
<!-- element style="font-size: 24px"-->
- Target: User(s) (literal children in this case)
- Attacker: 
Organization
- Benefit: 
surveillance
- Is “Find my friend” Malware?
- What happens if someone 
compromises
 GoGuardian?


:::

::: right
![[0x01_slide_35_image.png|300]]
![[0x01_slide_35_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 4: Jamal Khashoggi Assasination
:::

::: left
<!-- element style="font-size: 24px"-->
- Target: Individual 
Attacker: Foriegn Government +  Mercenary 
Benefit: Political
:::

::: right
![[0x01_slide_36_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 5: Advertising 
:::

::: left
<!-- element style="font-size: 24px"-->
- Target: User
- “Attacker”: Company
- Benefit: Money $$$$$$
- Remember Wacom? They were using Google Analytics 
- Note Facebook and Google are not intelligence companies per say.
- That said, they collect data that the intelligence community (IC) would kill for.
- Make no mistake, digital marketing companies have impressive surveillance capabilities 

:::

::: right
![[0x01_slide_37_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Example 6: Opportunistic Mass Exploitation
:::

::: left
<!-- element style="font-size: 24px"-->
- Saltstack RCE
- Target: LineageOS, GHost, DigiCert (anyone vulnerable to a specific exploit)
- Attacker: various
- Benefit
: Financial 
- What else could they have done? 
- https://thehackernews.com/2020/05/saltstack-rce-exploit.html

:::

::: right
![[0x01_slide_38_image.png|300]]


:::

---
<!-- slide template="[[Title Slide]]" -->
 ## Malware 101
---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### What platforms does Malware target?
:::

::: left
<!-- element style="font-size: 24px"-->
- Anything that can run code is 
susceptible
 to malware 

:::

::: right
![[0x01_slide_40_image.png|300]]
![[0x01_slide_40_image.png|300]]
![[0x01_slide_40_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Definitions: Common types of malware 

:::

<!-- element style="font-size: 24px"-->
- Packer: 
a tool that compresses, encrypts, and/or modifies an executable usually for the purpose of defense evasion .
- Loader / Dropper: 
software that downloads and executes other 
malicious
 programs.
- Spreader/Worm: 
software designed to spread 
malicious
 content on the system/executes the first of the attack. A virus. 
- Miner: 
malicious software that mines cryptocurrency on a victim machine. 
- Locker/Wiper: 
malware that encrypts/destroys files on a victim machine .
- Backdoor
Similar to a loader/dropper but specifically designed to regain access 
- Spyware/RAT: 
collections of tools designed to spy on the victim machine that usually controlled by a remote server. 
- Stealer
Similar to spyware, but generally pillages a computer for all available passwords, crypto wallets...etc  and exits. 
- Implant: 
catch all term for malware “implanted” on a victim machine 


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Definitions: Less common types of malware 

:::

::: left
<!-- element style="font-size: 24px"-->
- Rootkit
Generally speaking this is a subclass of spyware. Rootkits are deployed on victim machines that usually have been “rooted” or where the attacker has escalated their privileges on the device. They usually try to hide their existence by hiding (among other things) processes,  network traffic/connections, and files from the OS. Subclasses are defined based on what ring they run in.  
- Is a debugger a rootkit?
- What about Riot Game’s Anti Cheat engine for Valloran?

:::

::: right
![[0x01_slide_42_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### C2 / Command and Control

:::

<!-- element style="font-size: 24px"-->
- Malware is just code. It is created to perform a job, and usually takes its marching orders from, and sends results  to remote servers
- We call these servers Command and Control Servers (C2s) 
- We call the 
mechanism
 that sends data to and from C2 servers the 
C2 Channel
- Note some malware is autonomous (Wanacry)
- Some malware uses P2P communication (Game Over Zeus)
- Some malware is deployed as a larger “Post Exploitation” effort (Cobalt strike anyone?)


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Examples of C2 Channels
:::

::: left
<!-- element style="font-size: 24px"-->
- TCP
- UDP
- ICMP
- HTTP(s)/ HTTP2/HTTP3
- DNS
- TLS handshakes/heartbeats
- Trusted 3rd Parties 
- Other “Exotic” methods  


:::

::: right
![[0x01_slide_44_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### 
:::

::: left
<!-- element style="font-size: 24px"-->


:::

::: right
![[0x01_slide_45_image.jpg|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### 
:::

::: left
<!-- element style="font-size: 24px"-->


:::

::: right
![[0x01_slide_46_image.jpg|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### APT ChonkyBear

:::

<!-- element style="font-size: 24px"-->
- ChonkyBear
- Dropper
- Loader
- Backdoor
- Locker
- Shell
- Packer


---
<!-- slide template="[[Title Slide]]" -->
 ## How does Cyber Threat Analysis / Threat Hunting Work? 
---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Goal of Threat Hunting

:::

<!-- element style="font-size: 24px"-->
- Threat Hunting
: Searching environments to detect and isolate malicious activity.
- Blue Team
Analysis/Detection of new malicious activity, creating detection rules, attribution. 
- Red Team
Attribution re: attacker environments, and/or emulation of real malicious activity. 

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Goal of Threat Hunting

:::

<!-- element style="font-size: 24px"-->
- Threat Hunting
: Searching environments to detect and isolate malicious activity.
- Blue Team
Analysis/Detection of new malicious activity, creating detection rules, attribution. 
	- Finding new phishing emails, figuring out who is targeting your company and why, figuring out how to block malware or the emails from getting to your inbox in the first place. 
- Red Team
Attribution re: attacker environments, and/or emulation of real malicious activity.
	- Finding out there’s a bunch of phishing emails that compromised another company in your industry, and emulating the attack on your own company to see if it succeeded.
	- Identifying the actors who carried out the phishing campaign

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Frameworks for talking about Cyber Operations

:::

<!-- element style="font-size: 24px"-->
- There are a lot. Two of the more popular ones are
- Lockheed
 Martin Cyber Kill Chain 
- MITRE ATT&CK


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Cyber Killchain
:::

::: left
<!-- element style="font-size: 24px"-->
- Framework for identifying the steps an adversary takes to execute on a tactical objective 
- As defenders, if you can “break a link in the chain” you can disrupt an adversaries operation 


:::

::: right
![[0x01_slide_52_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### MITRE ATT&CK

:::

<!-- element style="font-size: 24px"-->
- Similar approach to Cyber Killchain
- Goes into detail about specific TTPs: Tactics, Techniques, and procedures 
- Is an industry standard for talking about how an objective was achieved or how an action was performed
- https://attack.mitre.org/matrices/enterprise/
- https://attack.mitre.org/resources/faq/
- This course takes many of its definitions from MITRE
- It is far from a perfect framework, but it is another (incredibly useful) tool in your arsenal


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### TTPs: Tactics 
:::

::: left
<!-- element style="font-size: 24px"-->
- Tactics represent the ‘why’ of an ATT&CK technique or sub-technique.
-  It is the adversary’s tactical goal: the reason for performing an action. For example, an adversary may want to achieve credential access.”
- Example: Disrupting Iran’s nuclear program


:::

::: right
![[0x01_slide_54_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### TTPs: Techniques
:::

::: left
<!-- element style="font-size: 24px"-->
- “Techniques represent “how” an adversary achieves a tactical goal by performing an action. For example, an adversary may dump credentials to achieve credential access.”
- This includes the tools used, and you will 
sometimes hear me slip up and say 
tactics tools and procedures


:::

::: right
![[0x01_slide_55_image.png|300]]
![[0x01_slide_55_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### TTPs: Sub-Technique 
:::

::: left
<!-- element style="font-size: 24px"-->
- Sub-techniques are a more specific description of the adversarial behavior used to achieve a goal. They describe behavior at a lower level than a technique. For example, an adversary may dump credentials by accessing the Local Security Authority (LSA) Secrets.”

:::

::: right
![[0x01_slide_56_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### TTPs: Procedures
:::

::: left
<!-- element style="font-size: 24px"-->
- Procedures are the specific implementation the adversary uses for techniques or sub-techniques. For example, a procedure could be an adversary using PowerShell to inject into lsass.exe to dump credentials by scraping LSASS memory on a victim. Procedures are categorized in ATT&CK as the observed in the wild use of techniques in the ‘Procedure Examples’ section of technique pages.”
- I like to think of this as “what playbooks does this specific actor use”?

:::

::: right
![[0x01_slide_57_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### This course

:::

<!-- element style="font-size: 24px"-->
- In this class, we will mostly use MITRE ATT&CK
- It is a valuable framework for comparing cyber operations
- In particular, lets look at the previous example comparing APT28 and APT29


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### 
:::

::: left
<!-- element style="font-size: 24px"-->


:::

::: right
![[0x01_slide_59_image.jpg|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### More Definitions

:::

<!-- element style="font-size: 24px"-->
- Indicators of Compromise (IOCs):
 sets of forensic data found when malicious activity occurs. (IPs / domains of a C2 server, hash values of malware, email accounts of phishing email senders..etc)
- Hash value:
 the unique fingerprint of a single file 
- IP address: 
the address of a computer on a network.
- Domain Name:
 an entry for a A/AAAA record used by a DNS servers to map human friendly names (like google.com) to computer friendly IP addresses (8.8.8.8).


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### 
:::

::: left
<!-- element style="font-size: 24px"-->
- Blue team: how do I make sure this attacker can’t successfully compromise our network?
- Red team: how do I pretend to be this attacker to test under what circumstances we get past the blue team?


:::

::: right
![[0x01_slide_61_image.jpg|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Life of a Blue Teamer/ SOC analyst

:::

<!-- element style="font-size: 24px"-->
- Find Indicators of Compromise
- Move from Indicators of Compromise (IOCs) to  -> Tactics, techniques and procedures (TTPs)
- Protecting your Environment from the Tactics / 
Techniques
/ Procedures 
used
- Break Links in the “cyber killchain” 
- Eventually, threats evolve to combat your countermeasures. Go back to step 1 :)

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Threat Analysis Pyramid of Pain
:::

::: left
<!-- element style="font-size: 24px"-->


:::

::: right
![[0x01_slide_63_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Threat Analysis Pyramid of Pain
:::

::: left
<!-- element style="font-size: 24px"-->
- IOCs


:::

::: right
![[0x01_slide_64_image.png|300]]


:::

---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Threat Analysis Pyramid of Pain
:::

::: left
<!-- element style="font-size: 24px"-->
- Getting from IOCs -> TTPs:
- Hash -> Tools
: What malware family 
does
 this hash belong to? How are all these hashes similar? Can I block every instance of the malware? 
- IP/Domain -> Network Artifact
: How does the malware communicate with the C2? Can I look at common patterns in the network traffic and block that behavior?
- IOC -> TTPs: 
Is 
there a pattern in the way this group conducts operations? Do they drop multiple malware families? Do they look for specific data? How do I block this activity?


:::

::: right
![[0x01_slide_65_image.png|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Easy…until it isn’t!

:::

<!-- element style="font-size: 24px"-->
- Depending on the actor, the Pyramid of Pain might just be pain. 
- Hashes are easy, 
unless they use polymorphic code
- IPs are easy, 
unless they use thousands of addresses all of which are 
compromised
 infrastructure
. Hint: what happens when someone takes over a Kubernetes cluster or an admin cloud account?
- Domains are easy,
 unless they use a domain generating algorithm (DGA) or quickly change them
- Or…you know what if someone 
compromises
 a bunch of legitimate sites and use them to carry out  cyber operation?


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Different companies see different IOCs
:::

::: left
<!-- element style="font-size: 24px"-->
- Antivirus companies (Norton, McAfee) see the malware that attackers use.
- Mail providers (Gmail, Yahoo) see the phishing emails.
- Domain registrars (Namecheap / GoDaddy) see Command and Control registration.
- Nobody sees everything. 
Analysis is hard.
- You’re going to have to work as a team.  


:::

::: right
![[0x01_slide_67_image.jpg|300]]


:::

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Importance of Relationships	

:::

<!-- element style="font-size: 24px"-->
- Go out into the world and make friends. 
- Nobody has the complete picture
- collaborate
, communicate, and deconflict
- How can you check equities if you don’t ever reach out


---
<!-- slide template="[[Split Vertical]]" -->
::: title
 #### Remark on Infosec Savants
:::

::: left
<!-- element style="font-size: 24px"-->
- There are plenty of brilliant people working in infosec, but by and large there is no such thing as 
someone
 who has all the answers. 
- In fact, someone who claims they do is likely wrong, lying, or trying to sell you something. 
- There is no Infosec Dr. House. It’s probably just someone with a bit too much self confidence, and they probably are not fun to work with. 
- Cybersecurity is a team sport. 


:::

::: right
![[0x01_slide_69_image.png|300]]


:::

---
<!-- slide template="[[Title Slide]]" -->
 ## Reminder!
Different entities also use different jargon!
---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Class Progression (blue team side)

:::

<!-- element style="font-size: 24px"-->
- Analysing Malware
  -  (pulling out the IOCs in the malware)
- Example Assignment: Find all C2 domains, interesting files, and implant configuration, and imports!
- Writing up a Technical Report on the Malware
  -  (explaining the IOCs and how the malware works)
- Example Assignment: What is the malware trying to 
accomplish
- Creating Threat Hunting Rules to find more malware
- Example assignment: finding all code associated to APT Chonky bear in a collection of binaries

---
<!-- slide template="[[Base Slide]]" -->
::: title
#### Class Progression (blue team side)

:::

<!-- element style="font-size: 24px"-->
- Analysing First stage loaders: 
Analysing Malware
  -  (pulling out the IOCs in the malware)
- Writing up a Technical Report on the Malware
  -  (explaining the IOCs and how the malware works)
- Creating Threat Hunting Rules to find more malware

---
<!-- slide template="[[Title Slide]]" -->
 ## Discussion:
What do we need to control a computer?
