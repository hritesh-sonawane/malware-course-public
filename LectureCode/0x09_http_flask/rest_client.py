import requests
import os 

url = "http://localhost:5000/tasks"


def whoami(args):
    return os.popen('whoami').read()

def hostname(args):
    return os.popen('hostname').read()

def double(args):
    return [i *2 for i in args]


handlers = {
    'whoami':whoami,
    'hostname':hostname,
    'double': double
}

for i in range(10):
    r = requests.get(url)
    data = r.json()
    cmd = data['cmd']
    args = data['args']
    f = handlers.get(cmd)
    result = []
    if not f:
        result = ["invalid function"]
    else:
        result = f(args)
    requests.post(url, json=result)


