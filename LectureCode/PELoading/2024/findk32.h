#include <windows.h>

// #include <stdio.h>
#include <subauth.h>
PVOID GetKernel32BaseAddress();

FARPROC FindGetProcAddress(HMODULE kernel32Base);

typedef HMODULE(WINAPI *pLoadLibraryA)(LPCSTR lpLibFileName);
typedef FARPROC(WINAPI *pGetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
typedef BOOL(WINAPI *pCreateProcessA)(
    LPCSTR lpApplicationName, LPSTR lpCommandLine,
    LPSECURITY_ATTRIBUTES lpProcessAttributes,
    LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles,
    DWORD dwCreationFlags, LPVOID lpEnvironment, LPCSTR lpCurrentDirectory,
    LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
